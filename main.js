!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}var n=function(){function e(t,n){var r=t.data,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initialArray=r,this._renderer=o,this._container=document.querySelector(n)}var n,r;return n=e,(r=[{key:"renderItems",value:function(){var e=this;this._initialArray.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.append(e),console.log("Section: element",e)}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modal=t,this.closeButton=this.modal.querySelector(".button-close"),this.close=this.close.bind(this),this._handleEscClose=this._handleEscClose.bind(this),this._handleOutClose=this._handleOutClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this.modal.classList.add("modal_active")}},{key:"close",value:function(){this.modal.classList.remove("modal_active")}},{key:"_handleEscClose",value:function(e){"Escape"!==e.key&&"esc"!==e.key||this.close()}},{key:"_handleOutClose",value:function(e){e.target.classList.contains("modal_active")&&this.close(e)}},{key:"setEventListeners",value:function(){this.closeButton.addEventListener("click",this.close),this.modal.addEventListener("click",this._handleOutClose),document.addEventListener("keydown",this._handleEscClose)}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===l(o)?o:String(o)),r)}var o}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textNameElement=document.querySelector(t),this.textAboutElement=document.querySelector(n),this.editProfileName=document.querySelector(y),this.editProfileAbout=document.querySelector(p),this.getUserInfo=this.getUserInfo.bind(this),this.setUserInfo=this.setUserInfo.bind(this)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return this.editProfileName.value=this.textNameElement.innerText,this.editProfileAbout.value=this.textAboutElement.innerText,{name:this.textNameElement.innerText,about:this.textAboutElement.innerText}}},{key:"setUserInfo",value:function(e,t){this.textNameElement.textContent=e,this.textAboutElement.textContent=t,this.editProfileName.value=e,this.editProfileAbout.value=t}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),c=document.querySelector(".main-cards"),s=(document.querySelector(".main-text__name"),document.querySelector(".main-text__about"),".main-text__name"),f=".main-text__about",y=".edit-profile__name",p=".edit-profile__about",d=(document.querySelectorAll(".button-close"),document.querySelectorAll(".card__image"),document.querySelectorAll(".modal"),document.querySelector(".button-close"),document.querySelector(".button-edit")),m=document.querySelector(".button-add"),b=document.querySelector(".edit-profile"),v=document.querySelector(".add-place"),h=document.querySelector(".photo-popup"),_=(document.querySelector(".add-place__name"),document.querySelector(".add-place__link"),{formSelector:".form",inputSelector:".form__input",submitButtonSelector:".button-save",inactiveButtonClass:"button-inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active",errorSufix:"-error",formSelectorProfile:".edit-profile__form",formSelectorAddPlace:".add-place__form",cardTemplate:".card-template"}),S=new u(s,f);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==g(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===g(o)?o:String(o)),r)}var o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(r);if(o){var n=k(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).setEventListeners(),t}return t=l,(n=[{key:"open",value:function(e){E(k(l.prototype),"open",this).call(this);var t=document.querySelector(".photo-popup__image"),n=document.querySelector(".photo-popup__title");t.src=e.target.src,t.alt=e.target.alt,n.textContent=e.target.alt}},{key:"setEventListeners",value:function(){E(k(l.prototype),"setEventListeners",this).call(this)}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i),O=new j(h);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==L(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===L(o)?o:String(o)),r)}var o}var q=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._link=t.link,this._cardSelector=n,this._getTemplate=this._getTemplate.bind(this),this.generateCard=this.generateCard.bind(this)}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.cloneNode(!0)}},{key:"generateCard",value:function(){this._element=this._getTemplate(),this._setEventListeners();var e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__title");return e.src=this._link,e.alt=this._name,t.textContent=this._name,this._element}},{key:"_handleLikeCard",value:function(e){e.target.classList.toggle("button-like-active")}},{key:"_handleDeleteCard",value:function(e){e.target.closest(".card").remove()}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".button-like").addEventListener("click",(function(t){e._handleLikeCard(t)})),this._element.querySelector(".button-delete").addEventListener("click",(function(t){e._handleDeleteCard(t)})),this._element.querySelector(".card__image").addEventListener("click",(function(e){O.open(e)}))}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}function I(e,t,n){return(t=R(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===x(t)?t:String(t)}var A=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I(this,"_showInputError",(function(e,t){var n=r._formElement.querySelector(".".concat(e.id).concat(r._config.errorSufix));e.classList.add(r._config.inputErrorClass),n.textContent=t,n.classList.add(r._config.errorClass)})),I(this,"_hideInputError",(function(e){var t=r._formElement.querySelector(".".concat(e.id).concat(r._config.errorSufix));e.classList.remove(r._config.inputErrorClass),t.classList.remove(r._config.errorClass),t.textContent=""})),I(this,"_checkInputValidity",(function(e){e.validity.valid?r._hideInputError(e):r._showInputError(e,e.validationMessage)})),I(this,"_hasInvalidInput",(function(){return r._inputList.some((function(e){return!e.validity.valid}))})),I(this,"_toggleButtonState",(function(){r._hasInvalidInput()?(r._buttonElement.classList.add(r._config.inactiveButtonClass),r._buttonElement.disabled=!0):(r._buttonElement.classList.remove(r._config.inactiveButtonClass),r._buttonElement.disabled=!1)})),I(this,"_setEventListeners",(function(){r._inputList.forEach((function(e){e.addEventListener("input",(function(){r._checkInputValidity(e),r._toggleButtonState()}))})),r._formElement.addEventListener("reset",(function(){r._toggleButtonState()}))})),this._config=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(t.submitButtonSelector)}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._setEventListeners(),this._toggleButtonState()}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==B(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===B(o)?o:String(o)),r)}var o}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=D(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},V.apply(this,arguments)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}var J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=D(r);if(o){var n=D(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).setEventListeners(),t}return t=l,(n=[{key:"_setInputValues",value:function(){return S}},{key:"_getInputValues",value:function(){return S}},{key:"open",value:function(){V(D(l.prototype),"open",this).call(this)}},{key:"close",value:function(){V(D(l.prototype),"close",this).call(this),this.modal.className.includes("place")&&this.modal.querySelector(_.formSelectorAddPlace).reset()}},{key:"setEventListeners",value:function(){V(D(l.prototype),"setEventListeners",this).call(this),this.modal.classList.contains("profile")&&this._setInputValues(),this.modal.querySelector(".form").addEventListener("submit",(function(e){e.preventDefault()})),new A(_,this.modal).enableValidation()}}])&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i),M=new n({data:[{name:"Valle de Yosemite",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lago Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"MontaÃ±as Calvas",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Parque Nacional de la Vanoise",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:function(e){var t=new q(e,_.cardTemplate);c.appendChild(t.generateCard())}}),Y=new J(b),z=new J(v),F=new u(s,f);d.addEventListener("click",(function(){F.getUserInfo(),Y._getInputValues(),Y.open()})),m.addEventListener("click",(function(){z.open()})),b.addEventListener("submit",(function(){var e=document.forms.editProfile,t=e.elements.editProfileName,n=e.elements.editProfileAbout;F.setUserInfo(t.value,n.value),Y.close()})),v.addEventListener("submit",(function(){var e=document.forms.addPlace,t=e.elements.addPlaceName,n=e.elements.addPlaceLink,r=JSON.parse('{"name": "'.concat(t.value,'", "link": "').concat(n.value,'"}')),o=new q(r,_.cardTemplate);c.prepend(o.generateCard()),z.close()})),M.renderItems(),F.setUserInfo("Jacques Cousteau","Explorer")}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWdCLElBQUluRCxFQUFLa0QsRUFBYTVFLEVBQU9VLGNBQ25EakIsRUFBZXNHLFFBQVFsQixFQUFjNUMsZ0JBQ3JDK0MsRUFBYy9HLE9BQ2hCLElBb0JBMEcsRUFBbUJxQixjQUVuQmYsRUFBWTdGLFlMN0JnQixtQkFDQyxXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AtbWFpbi8uL3NyYy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AtbWFpbi8uL3NyYy9zY3JpcHRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLW1haW4vLi9zcmMvc2NyaXB0cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC1tYWluLy4vc3JjL3NjcmlwdHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLW1haW4vLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC1tYWluLy4vc3JjL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC1tYWluLy4vc3JjL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC1tYWluLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC1tYWluLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb257XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7ICAgXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pOyBcbiAgICB9KTtcbiAgfVxuICBcbiAgYWRkSXRlbShlbGVtZW50KXsgXG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KVxuICAgIGNvbnNvbGUubG9nKFwiU2VjdGlvbjogZWxlbWVudFwiLCBlbGVtZW50KVxuICB9O1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXB7XG5cbiAgY29uc3RydWN0b3IobW9kYWwpe1xuICAgIHRoaXMubW9kYWwgPSBtb2RhbDtcbiAgICB0aGlzLmNsb3NlQnV0dG9uID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmJ1dHRvbi1jbG9zZVwiKTtcblxuICAgIHRoaXMuY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZU91dENsb3NlID0gdGhpcy5faGFuZGxlT3V0Q2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuICBcbiAgb3Blbigpe1xuICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2FjdGl2ZVwiKTtcbiAgfTtcbiAgXG4gIGNsb3NlKCl7XG4gICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfYWN0aXZlXCIpO1xuICB9O1xuXG4gIF9oYW5kbGVFc2NDbG9zZShlKXsgXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiIHx8IGUua2V5ID09PSBcImVzY1wiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZU91dENsb3NlKGUpeyBcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfYWN0aXZlXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKGUpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCl7XG4gICAgdGhpcy5jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZSk7XG4gICAgdGhpcy5tb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3V0Q2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxufSIsImltcG9ydCB7IGVkaXRQcm9maWxlQWJvdXQsIGVkaXRQcm9maWxlTmFtZSB9IGZyb20gXCIuL2NvbnN0YW50cy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuXG4gIGNvbnN0cnVjdG9yKHRleHROYW1lLCB0ZXh0QWJvdXQpIHtcbiAgICBcbiAgICB0aGlzLnRleHROYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGV4dE5hbWUpO1xuICAgIHRoaXMudGV4dEFib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGV4dEFib3V0KTtcblxuICAgIHRoaXMuZWRpdFByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlZGl0UHJvZmlsZU5hbWUpXG4gICAgdGhpcy5lZGl0UHJvZmlsZUFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlZGl0UHJvZmlsZUFib3V0KTtcblxuICAgIHRoaXMuZ2V0VXNlckluZm8gPSB0aGlzLmdldFVzZXJJbmZvLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRVc2VySW5mbyA9IHRoaXMuc2V0VXNlckluZm8uYmluZCh0aGlzKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCl7XG5cbiAgICB0aGlzLmVkaXRQcm9maWxlTmFtZS52YWx1ZSA9IHRoaXMudGV4dE5hbWVFbGVtZW50LmlubmVyVGV4dDtcbiAgICB0aGlzLmVkaXRQcm9maWxlQWJvdXQudmFsdWUgPSB0aGlzLnRleHRBYm91dEVsZW1lbnQuaW5uZXJUZXh0O1xuXG4gICAgY29uc3QgVXNlckluZm9PYmplY3QgPSB7IG5hbWU6IHRoaXMudGV4dE5hbWVFbGVtZW50LmlubmVyVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvdXQ6IHRoaXMudGV4dEFib3V0RWxlbWVudC5pbm5lclRleHQgfVxuXG4gICAgcmV0dXJuIFVzZXJJbmZvT2JqZWN0O1xuICB9O1xuXG4gIHNldFVzZXJJbmZvKG5hbWUsYWJvdXQpIHtcbiAgICB0aGlzLnRleHROYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy50ZXh0QWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gICAgdGhpcy5lZGl0UHJvZmlsZU5hbWUudmFsdWUgPSBuYW1lO1xuICAgIHRoaXMuZWRpdFByb2ZpbGVBYm91dC52YWx1ZSA9IGFib3V0O1xuICB9O1xufSIsImltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi9Vc2VySW5mby5qc1wiO1xuXG5leHBvcnQgY29uc3QgY2FyZHNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY2FyZHNcIik7XG5leHBvcnQgY29uc3QgdGV4dE5hbWVTZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi10ZXh0X19uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHRleHRBYm91dFNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLXRleHRfX2Fib3V0XCIpOyBcbmV4cG9ydCBjb25zdCB0ZXh0TmFtZSA9IFwiLm1haW4tdGV4dF9fbmFtZVwiO1xuZXhwb3J0IGNvbnN0IHRleHRBYm91dCA9IFwiLm1haW4tdGV4dF9fYWJvdXRcIjtcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZU5hbWUgPSBcIi5lZGl0LXByb2ZpbGVfX25hbWVcIjtcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUFib3V0ID0gXCIuZWRpdC1wcm9maWxlX19hYm91dFwiO1xuXG5leHBvcnQgY29uc3QgY2xvc2VNb2RhbEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJ1dHRvbi1jbG9zZVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkSW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXJkX19pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xuXG5leHBvcnQgY29uc3QgY2xvc2VNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnV0dG9uLWNsb3NlXCIpO1xuZXhwb3J0IGNvbnN0IG9wZW5FZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnV0dG9uLWVkaXRcIik7XG5leHBvcnQgY29uc3Qgb3BlbkFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idXR0b24tYWRkXCIpO1xuZXhwb3J0IGNvbnN0IG9wZW5FZGl0UHJvZmlsZVBvcFVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXByb2ZpbGVcIik7XG5leHBvcnQgY29uc3Qgb3BlbkFkZFBsYWNlUG9wVXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1wbGFjZVwiKTtcbmV4cG9ydCBjb25zdCBvcGVuUGhvdG9Qb3BVcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tcG9wdXBcIik7XG5leHBvcnQgY29uc3QgYWRkUGxhY2VOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcGxhY2VfX25hbWVcIik7XG5leHBvcnQgY29uc3QgYWRkUGxhY2VMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcGxhY2VfX2xpbmtcIik7XG5cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5idXR0b24tc2F2ZVwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImJ1dHRvbi1pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxuICBlcnJvclN1Zml4OiBcIi1lcnJvclwiLFxuICBmb3JtU2VsZWN0b3JQcm9maWxlOiBcIi5lZGl0LXByb2ZpbGVfX2Zvcm1cIixcbiAgZm9ybVNlbGVjdG9yQWRkUGxhY2U6IFwiLmFkZC1wbGFjZV9fZm9ybVwiLFxuICBjYXJkVGVtcGxhdGU6IFwiLmNhcmQtdGVtcGxhdGVcIlxufVxuXG5leHBvcnQgY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8odGV4dE5hbWUsIHRleHRBYm91dClcblxuZXhwb3J0IGNvbnN0IG9yaWdpbmFsTmFtZSA9IFwiSmFjcXVlcyBDb3VzdGVhdVwiO1xuZXhwb3J0IGNvbnN0IG9yaWdpbmFsQWJvdXQgPSBcIkV4cGxvcmVyXCI7XG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIlZhbGxlIGRlIFlvc2VtaXRlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIlxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCJcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW9udGHDsWFzIENhbHZhc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCJcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIlxuICB9LFxuICB7XG4gICAgbmFtZTogXCJQYXJxdWUgTmFjaW9uYWwgZGUgbGEgVmFub2lzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIlxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIlxuICB9XG5dOyIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5pbXBvcnQgeyBvcGVuUGhvdG9Qb3BVcCB9IGZyb20gXCIuL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG5cbiAgY29uc3RydWN0b3Iob3BlblBob3RvUG9wVXApIHtcbiAgICBzdXBlcihvcGVuUGhvdG9Qb3BVcCk7XG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgb3BlbihlKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIGNvbnN0IGltZ1BvcHVwID1cbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tcG9wdXBfX2ltYWdlXCIpO1xuICAgIGNvbnN0IHRpdGxlUG9wdXAgPVxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1wb3B1cF9fdGl0bGVcIik7XG4gICAgaW1nUG9wdXAuc3JjID0gZS50YXJnZXQuc3JjO1xuICAgIGltZ1BvcHVwLmFsdCA9IGUudGFyZ2V0LmFsdDtcbiAgICB0aXRsZVBvcHVwLnRleHRDb250ZW50ID0gZS50YXJnZXQuYWx0O1xuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCl7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG5cbn1cblxuZXhwb3J0IGNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKG9wZW5QaG90b1BvcFVwKTsiLCJpbXBvcnQgeyBwb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9nZXRUZW1wbGF0ZSA9IHRoaXMuX2dldFRlbXBsYXRlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5nZW5lcmF0ZUNhcmQgPSB0aGlzLmdlbmVyYXRlQ2FyZC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudFxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICByZXR1cm4gY2FyZFRlbXBsYXRlO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX2hhbmRsZUxpa2VDYXJkKGUpIHtcbiAgICBlLnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiYnV0dG9uLWxpa2UtYWN0aXZlXCIpO1xuICB9XG5cbiAgX2hhbmRsZURlbGV0ZUNhcmQoZSkge1xuICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCIuY2FyZFwiKS5yZW1vdmUoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5idXR0b24tbGlrZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZChlKVxuICAgICAgfSlcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5idXR0b24tZGVsZXRlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoZSlcbiAgICAgIH0pXG5cbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihlKVxuICAgICAgfSlcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3J7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZyxmb3JtU2VsZWN0b3Ipe1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1TZWxlY3RvcjtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCxlcnJvck1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9JHt0aGlzLl9jb25maWcuZXJyb3JTdWZpeH1gKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICB9O1xuICBcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0ke3RoaXMuX2NvbmZpZy5lcnJvclN1Zml4fWApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuICBcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfTtcblxuICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT4geyBcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gXG4gICAgICAgIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KVxuICAgIH0pXG4gICAgXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpe1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufSIsImltcG9ydCB7IGNvbmZpZywgdXNlckluZm8gfSBmcm9tIFwiLi9jb25zdGFudHMuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsKSB7XG4gICAgc3VwZXIobW9kYWwpO1xuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuICBcbiAgX3NldElucHV0VmFsdWVzKCl7XG4gICAgcmV0dXJuIHVzZXJJbmZvO1xuICB9XG4gIFxuICBfZ2V0SW5wdXRWYWx1ZXMoKXtcbiAgICByZXR1cm4gdXNlckluZm87XG4gIH1cblxuICBvcGVuKCl7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG4gXG4gIGNsb3NlKCl7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICBpZih0aGlzLm1vZGFsLmNsYXNzTmFtZS5pbmNsdWRlcyhcInBsYWNlXCIpKXtcbiAgICAgIHRoaXMubW9kYWwucXVlcnlTZWxlY3Rvcihjb25maWcuZm9ybVNlbGVjdG9yQWRkUGxhY2UpLnJlc2V0KCk7XG4gICAgfVxuICB9XG4gIFxuICBzZXRFdmVudExpc3RlbmVycygpeyAgICBcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIFxuICAgIGlmKHRoaXMubW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwicHJvZmlsZVwiKSl7XG4gICAgICB0aGlzLl9zZXRJbnB1dFZhbHVlcygpXG4gICAgfVxuICAgIFxuICAgIHRoaXMubW9kYWwucXVlcnlTZWxlY3RvcignLmZvcm0nKS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSlcbiAgICBcbiAgICBjb25zdCBuZXdGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLHRoaXMubW9kYWwpO1xuICAgIG5ld0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9XG59IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuL3NjcmlwdHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4vc2NyaXB0cy9DYXJkLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vc2NyaXB0cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4vc2NyaXB0cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGNhcmRzQ29udGFpbmVyLFxuICBvcGVuQWRkUGxhY2VQb3BVcCxcbiAgb3BlbkVkaXRQcm9maWxlUG9wVXAsXG4gIG9wZW5FZGl0UHJvZmlsZUJ1dHRvbixcbiAgb3BlbkFkZFBsYWNlQnV0dG9uLFxuICBjb25maWcsXG4gIHRleHROYW1lLFxuICB0ZXh0QWJvdXQsXG4gIG9yaWdpbmFsQWJvdXQsXG4gIG9yaWdpbmFsTmFtZSxcbn0gZnJvbSBcIi4vc2NyaXB0cy9jb25zdGFudHMuanNcIjtcblxuY29uc3QgaGFuZGxlSW5pdGlhbENhcmRzID0gbmV3IFNlY3Rpb24gKHtcbiAgZGF0YTogaW5pdGlhbENhcmRzLFxuICByZW5kZXJlcjogKGNhcmROZXdJdGVtKSA9PiB7XG4gICAgY29uc3QgY3JlYXRlTmV3Q2FyZCA9IG5ldyBDYXJkKGNhcmROZXdJdGVtLCBjb25maWcuY2FyZFRlbXBsYXRlKTtcbiAgICBjYXJkc0NvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVOZXdDYXJkLmdlbmVyYXRlQ2FyZCgpKTsgICAgIFxuICB9XG59KTtcblxuY29uc3QgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQgPSAoKSA9PiB7XG4gIGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMuZWRpdFByb2ZpbGU7XG4gIGNvbnN0IG5ld05hbWUgPSBwcm9maWxlRm9ybS5lbGVtZW50cy5lZGl0UHJvZmlsZU5hbWU7XG4gIGNvbnN0IG5ld0Fib3V0ID0gcHJvZmlsZUZvcm0uZWxlbWVudHMuZWRpdFByb2ZpbGVBYm91dDtcblxuICBBZGRVc2VySW5mby5zZXRVc2VySW5mbyhuZXdOYW1lLnZhbHVlLCBuZXdBYm91dC52YWx1ZSk7XG4gIFBvcFVwRWRpdFByb2ZpbGUuY2xvc2UoKTtcbn1cblxuY29uc3QgaGFuZGxlQWRkUGxhY2VGb3JtU3VibWl0ID0gKCkgPT4ge1xuICBjb25zdCBhZGRQbGFjZUZvcm0gPSBkb2N1bWVudC5mb3Jtcy5hZGRQbGFjZTtcbiAgY29uc3QgYWRkUGxhY2VOYW1lID0gYWRkUGxhY2VGb3JtLmVsZW1lbnRzLmFkZFBsYWNlTmFtZTtcbiAgY29uc3QgYWRkUGxhY2VMaW5rID0gYWRkUGxhY2VGb3JtLmVsZW1lbnRzLmFkZFBsYWNlTGluaztcblxuICBjb25zdCBjYXJkTmV3SXRlbSA9IEpTT04ucGFyc2UoYHtcIm5hbWVcIjogXCIke2FkZFBsYWNlTmFtZS52YWx1ZX1cIiwgXCJsaW5rXCI6IFwiJHthZGRQbGFjZUxpbmsudmFsdWV9XCJ9YCk7XG5cbiAgY29uc3QgY3JlYXRlTmV3Q2FyZCA9IG5ldyBDYXJkKGNhcmROZXdJdGVtLCBjb25maWcuY2FyZFRlbXBsYXRlKTtcbiAgY2FyZHNDb250YWluZXIucHJlcGVuZChjcmVhdGVOZXdDYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbiAgUG9wVXBBZGRQaG90by5jbG9zZSgpO1xufVxuXG5jb25zdCBQb3BVcEVkaXRQcm9maWxlICA9IG5ldyBQb3B1cFdpdGhGb3JtKG9wZW5FZGl0UHJvZmlsZVBvcFVwKTtcbmNvbnN0IFBvcFVwQWRkUGhvdG8gICAgID0gbmV3IFBvcHVwV2l0aEZvcm0ob3BlbkFkZFBsYWNlUG9wVXApO1xuY29uc3QgQWRkVXNlckluZm8gICAgICAgPSBuZXcgVXNlckluZm8odGV4dE5hbWUsIHRleHRBYm91dCk7XG5cblxub3BlbkVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIEFkZFVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIFBvcFVwRWRpdFByb2ZpbGUuX2dldElucHV0VmFsdWVzKCk7XG4gIFBvcFVwRWRpdFByb2ZpbGUub3BlbigpO1xufSk7XG5cbm9wZW5BZGRQbGFjZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBQb3BVcEFkZFBob3RvLm9wZW4oKTtcbn0pO1xuXG5vcGVuRWRpdFByb2ZpbGVQb3BVcC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbm9wZW5BZGRQbGFjZVBvcFVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkUGxhY2VGb3JtU3VibWl0KTtcblxuaGFuZGxlSW5pdGlhbENhcmRzLnJlbmRlckl0ZW1zKCk7XG5cbkFkZFVzZXJJbmZvLnNldFVzZXJJbmZvKG9yaWdpbmFsTmFtZSxvcmlnaW5hbEFib3V0KTsiXSwibmFtZXMiOlsiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsImRhdGEiLCJyZW5kZXJlciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfaW5pdGlhbEFycmF5IiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImtleSIsInZhbHVlIiwiX3RoaXMiLCJmb3JFYWNoIiwiaXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJjb25zb2xlIiwibG9nIiwiUG9wdXAiLCJtb2RhbCIsImNsb3NlQnV0dG9uIiwiY2xvc2UiLCJiaW5kIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZU91dENsb3NlIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiZSIsInRhcmdldCIsImNvbnRhaW5zIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlVzZXJJbmZvIiwidGV4dE5hbWUiLCJ0ZXh0QWJvdXQiLCJ0ZXh0TmFtZUVsZW1lbnQiLCJ0ZXh0QWJvdXRFbGVtZW50IiwiZWRpdFByb2ZpbGVOYW1lIiwiZWRpdFByb2ZpbGVBYm91dCIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJpbm5lclRleHQiLCJuYW1lIiwiYWJvdXQiLCJ0ZXh0Q29udGVudCIsImNhcmRzQ29udGFpbmVyIiwib3BlbkVkaXRQcm9maWxlQnV0dG9uIiwicXVlcnlTZWxlY3RvckFsbCIsIm9wZW5BZGRQbGFjZUJ1dHRvbiIsIm9wZW5FZGl0UHJvZmlsZVBvcFVwIiwib3BlbkFkZFBsYWNlUG9wVXAiLCJvcGVuUGhvdG9Qb3BVcCIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZXJyb3JTdWZpeCIsImZvcm1TZWxlY3RvclByb2ZpbGUiLCJmb3JtU2VsZWN0b3JBZGRQbGFjZSIsImNhcmRUZW1wbGF0ZSIsInVzZXJJbmZvIiwiUG9wdXBXaXRoSW1hZ2UiLCJfUG9wdXAiLCJfaW5oZXJpdHMiLCJfc3VwZXIiLCJjYWxsIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfZ2V0IiwiX2dldFByb3RvdHlwZU9mIiwicHJvdG90eXBlIiwiaW1nUG9wdXAiLCJ0aXRsZVBvcHVwIiwic3JjIiwiYWx0IiwicG9wdXBXaXRoSW1hZ2UiLCJDYXJkIiwiY2FyZFNlbGVjdG9yIiwiX25hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2dldFRlbXBsYXRlIiwiZ2VuZXJhdGVDYXJkIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9lbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwidG9nZ2xlIiwiY2xvc2VzdCIsIl9oYW5kbGVMaWtlQ2FyZCIsIl9oYW5kbGVEZWxldGVDYXJkIiwib3BlbiIsIkZvcm1WYWxpZGF0b3IiLCJfZGVmaW5lUHJvcGVydHkiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJjb25jYXQiLCJpZCIsIl9jb25maWciLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaW5wdXRMaXN0Iiwic29tZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIkFycmF5IiwiZnJvbSIsIlBvcHVwV2l0aEZvcm0iLCJjbGFzc05hbWUiLCJpbmNsdWRlcyIsInJlc2V0IiwiX3NldElucHV0VmFsdWVzIiwicHJldmVudERlZmF1bHQiLCJlbmFibGVWYWxpZGF0aW9uIiwiaGFuZGxlSW5pdGlhbENhcmRzIiwiY2FyZE5ld0l0ZW0iLCJjcmVhdGVOZXdDYXJkIiwiYXBwZW5kQ2hpbGQiLCJQb3BVcEVkaXRQcm9maWxlIiwiUG9wVXBBZGRQaG90byIsIkFkZFVzZXJJbmZvIiwiX2dldElucHV0VmFsdWVzIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsImVkaXRQcm9maWxlIiwibmV3TmFtZSIsImVsZW1lbnRzIiwibmV3QWJvdXQiLCJhZGRQbGFjZUZvcm0iLCJhZGRQbGFjZSIsImFkZFBsYWNlTmFtZSIsImFkZFBsYWNlTGluayIsIkpTT04iLCJwYXJzZSIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyJdLCJzb3VyY2VSb290IjoiIn0=